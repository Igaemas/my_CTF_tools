import sys
from pwn import *

ALPHA = list("abcdefghijklmnopqrstuvwxyz")

def appendACharacter(data):
    result = ""
    i = 1
    if len(data) == 4:
        return data
    while len(result) < 4:
        result = "a" * i + data
        i += 1
    if result == "aaaa":
        result = ""
    return result

def createPattern(n):
    i = 0
    cycle = 1
    result = ALPHA[i]
    while len(result) < int(n):
        i = (i + 1) % len(ALPHA)
        if i == 0:
            cycle += 1
        result += appendACharacter(ALPHA[i] * cycle)
    return result

def find_overflow_position(patern, patern_list):
    position = patern_list.find(patern)
    return position

def createTestPayload(bytes_number):
    payload = "A" * bytes_number + "B" * 4 + "C" * 20
    return payload

def main():
    if sys.argv[1] == '-l':
        patern_list = createPattern(405)
        patern = sys.argv[2]
        buffer_position = find_overflow_position(patern, patern_list)
        log.info(buffer_position)
        log.info(createTestPayload(buffer_position))
    else:
        user_input = sys.argv[1]
        log.info(createPattern(user_input))

main()